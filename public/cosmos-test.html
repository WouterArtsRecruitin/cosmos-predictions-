<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmos Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            background: #000012; 
            color: white; 
            overflow: hidden; 
        }
        #container { 
            width: 100vw; 
            height: 100vh; 
            position: relative; 
        }
        #ui {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            text-align: center;
        }
        input {
            padding: 10px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: white;
            width: 300px;
        }
        button {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            color: white;
            margin-top: 10px;
            cursor: pointer;
        }
        button:hover { background: rgba(255,255,255,0.2); }
        #debug {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 12px;
            color: #888;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="debug">
        <div>Three.js Status: <span id="status">Loading...</span></div>
        <div>Stars: <span id="star-count">0</span></div>
        <div>Camera: <span id="camera-pos">Unknown</span></div>
    </div>
    
    <div id="ui">
        <h2>Cosmos Predictions</h2>
        <input type="text" placeholder="Vraag de cosmos over jouw toekomst..." id="question">
        <br>
        <button onclick="predict()">Voorspel</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, stars;
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let isMouseDown = false;

        function init() {
            console.log('Initializing Three.js...');
            document.getElementById('status').textContent = 'Initializing...';
            
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000012);
            
            // Camera
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 2000);
            camera.position.set(0, 0, 80);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.getElementById('container').appendChild(renderer.domElement);
            
            console.log('Creating stars...');
            createStars();
            
            console.log('Adding event listeners...');
            addEventListeners();
            
            console.log('Starting animation...');
            animate();
            
            document.getElementById('status').textContent = 'Ready!';
            updateDebugInfo();
        }

        function createStars() {
            const starCount = 10000;
            const geometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];
            
            console.log(`Creating ${starCount} stars...`);
            
            for (let i = 0; i < starCount; i++) {
                // Simple spherical distribution
                let radius;
                if (Math.random() < 0.5) {
                    radius = Math.random() * 20; // Core
                } else {
                    radius = 20 + Math.random() * 40; // Halo
                }
                
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                
                const x = radius * Math.sin(phi) * Math.cos(theta);
                const y = radius * Math.sin(phi) * Math.sin(theta);
                const z = radius * Math.cos(phi);
                
                positions.push(x, y, z);
                
                // Simple white stars
                colors.push(1, 1, 1);
            }
            
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
            
            const material = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 2,
                sizeAttenuation: true
            });
            
            stars = new THREE.Points(geometry, material);
            scene.add(stars);
            
            document.getElementById('star-count').textContent = starCount;
            console.log('Stars created and added to scene');
        }

        function addEventListeners() {
            window.addEventListener('resize', onWindowResize);
            
            renderer.domElement.addEventListener('mousedown', onMouseDown);
            renderer.domElement.addEventListener('mousemove', onMouseMove);
            renderer.domElement.addEventListener('mouseup', onMouseUp);
            renderer.domElement.addEventListener('wheel', onWheel);
        }

        function onMouseDown(event) {
            isMouseDown = true;
            mouseX = event.clientX;
            mouseY = event.clientY;
        }

        function onMouseMove(event) {
            if (isMouseDown) {
                const deltaX = event.clientX - mouseX;
                const deltaY = event.clientY - mouseY;
                
                targetRotationY += deltaX * 0.005;
                targetRotationX += deltaY * 0.005;
                
                mouseX = event.clientX;
                mouseY = event.clientY;
            }
        }

        function onMouseUp() {
            isMouseDown = false;
        }

        function onWheel(event) {
            const zoomFactor = event.deltaY > 0 ? 1.1 : 0.9;
            camera.position.multiplyScalar(zoomFactor);
            camera.position.clampLength(20, 200);
            updateDebugInfo();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            if (stars) {
                // Smooth rotation
                stars.rotation.y += (targetRotationY - stars.rotation.y) * 0.05;
                stars.rotation.x += (targetRotationX - stars.rotation.x) * 0.05;
                
                // Auto rotation when not interacting
                if (!isMouseDown) {
                    targetRotationY += 0.001;
                }
            }
            
            renderer.render(scene, camera);
        }

        function updateDebugInfo() {
            const pos = camera.position;
            document.getElementById('camera-pos').textContent = 
                `(${pos.x.toFixed(1)}, ${pos.y.toFixed(1)}, ${pos.z.toFixed(1)})`;
        }

        function predict() {
            const question = document.getElementById('question').value;
            if (question.trim()) {
                alert(`Vraag ontvangen: "${question}"\n\nDit zou normaal naar de AI gaan voor voorspellingen!`);
            }
        }

        // Start everything
        console.log('Starting cosmos test...');
        init();
    </script>
</body>
</html>